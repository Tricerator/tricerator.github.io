<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Jednoduch√° hra ‚Äì Ovoce</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: #f0f0f0;
    }

    #hud {
        padding: 10px;
        background: #333;
        color: white;
        font-size: 18px;
    }

    #gameArea {
        position: relative;
        width: 100vw;
        height: calc(100vh - 50px);
        background: #eee;
        overflow: hidden;
        cursor: crosshair;
    }

    .square {
        position: absolute;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 0, 0, 0.05); /* jemn√Ω hitbox */
        user-select: none;
    }

    /* LEVEL OVERLAY */
    #levelOverlay {
        position: fixed;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.85);
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 60px;
        font-weight: bold;
        z-index: 9999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s linear;
    }

    #levelOverlay.visible {
        opacity: 1;
        pointer-events: auto;
    }

    #levelText {
        text-align: center;
        padding: 20px;
        animation: none;
    }

    /* Animace textu v overlayi */
    #levelOverlay.visible #levelText {
        animation: popIn 1.0s ease-out;
    }

    @keyframes popIn {
        0%   { transform: scale(0.5); opacity: 0; }
        50%  { transform: scale(1.2); opacity: 1; }
        100% { transform: scale(1.0); opacity: 1; }
    }

    /* Trochu men≈°√≠ text HUD na √∫zk√Ωch displej√≠ch */
    @media (max-width: 768px) {
        #hud {
            font-size: 14px;
        }
    }
</style>
</head>
<body>

<div id="hud">
    ‚è± ƒåas: <span id="time">0.0</span> s  
    | üéØ Sk√≥re: <span id="hit">0</span>/<span id="total">0</span>
    | üî• √örove≈à: <span id="level">1</span> (ka≈æd√Ωch 10 z√°sah≈Ø)
    | P = pauza, klik = start
</div>

<div id="gameArea"></div>

<div id="levelOverlay">
    <div id="levelText"></div>
</div>

<!-- Zvuky (voliteln√© ‚Äì m≈Ø≈æe≈° nahradit nebo smazat) -->
<audio id="hitSound" src="hit.wav" preload="auto"></audio>
<audio id="missSound" src="miss.wav" preload="auto"></audio>

<script>
let gameRunning   = false;
let time          = 0;
let hit           = 0;
let total         = 0;
let level         = 1;

let timerInterval = null;
let spawnInterval = null;

// po kolika z√°saz√≠ch se zvedne level
const HITS_PER_LEVEL = 10;

// z√°kladn√≠ parametry obt√≠≈ænosti
let baseSpawnDelay = 800;   // ms
let baseLifetime   = 2000;  // ms
let baseSquareSize = 80;    // px

const minSpawnDelay = 250;
const minLifetime   = 500;
const minSquareSize = 20;

// jednoduch√Ω "detekce mobilu" podle ≈°√≠≈ôky
const isSmallScreen = window.innerWidth < 768;

// pro mal√© displeje to trochu zlehƒç√≠me
if (isSmallScreen) {
    baseSquareSize = 100;
    baseLifetime   = 2500;
}

let spawnDelay = baseSpawnDelay;
let lifetime   = baseLifetime;
let squareSize = baseSquareSize;

const timeEl   = document.getElementById("time");
const hitEl    = document.getElementById("hit");
const totalEl  = document.getElementById("total");
const levelEl  = document.getElementById("level");
const gameArea = document.getElementById("gameArea");

const levelOverlay = document.getElementById("levelOverlay");
const levelText    = document.getElementById("levelText");

const hitSound  = document.getElementById("hitSound");
const missSound = document.getElementById("missSound");

// Ovoce pro objekty
const fruits = ["üçé","üçå","üçá","üçí","üçâ","üçç","üçì","ü•ù"];

// N√°zvy ovoce pro levely (pro text v overlayi)
const levelFruits = [
    "üçé Jablko",
    "üçå Ban√°n",
    "üçá Hrozny",
    "üçì Jahoda",
    "üçí T≈ôe≈°e≈à",
    "üçç Ananas",
    "üçâ Meloun",
    "ü•ù Kiwi"
];

function randomFruit() {
    return fruits[Math.floor(Math.random() * fruits.length)];
}

// ---- ƒåASOM√çRA ----
function startTimer() {
    if (timerInterval) return;
    timerInterval = setInterval(() => {
        time += 0.1;
        timeEl.textContent = time.toFixed(1);
    }, 100);
}

function stopTimer() {
    clearInterval(timerInterval);
    timerInterval = null;
}

// ---- ZVUKY ----
function playSound(sound) {
    if (!sound) return;
    try {
        sound.currentTime = 0;
        sound.play();
    } catch (e) {
        // autoplay blok ‚Äì ignorujeme
    }
}

// ---- OBT√ç≈ΩNOST PODLE LEVELU ----
function applyDifficultyForLevel() {
    const l = Math.max(1, level);

    spawnDelay = Math.max(minSpawnDelay, baseSpawnDelay - (l - 1) * 60);
    lifetime   = Math.max(minLifetime,   baseLifetime   - (l - 1) * 150);
    squareSize = Math.max(minSquareSize, baseSquareSize - (l - 1) * 6);
}

// ---- LEVEL OVERLAY ----
function showLevelOverlay(levelNumber) {
    const fruitName = levelFruits[(levelNumber - 1) % levelFruits.length];

    levelText.textContent = "LEVEL " + levelNumber + " ‚Äì " + fruitName;

    // Zastavit hru
    gameRunning = false;
    stopTimer();
    stopSpawning();

    // Zobrazit overlay
    levelOverlay.classList.add("visible");

    // Po 1.2 s schovat overlay a pokraƒçovat
    setTimeout(() => {
        levelOverlay.classList.remove("visible");
        gameRunning = true;
        startTimer();
        startSpawning();
    }, 1200);
}

// ---- KONTROLA LEVELU PODLE SK√ìRE ----
function checkLevelUp() {
    const newLevel = Math.floor(hit / HITS_PER_LEVEL) + 1;
    if (newLevel > level) {
        level = newLevel;
        levelEl.textContent = level;
        applyDifficultyForLevel();
        showLevelOverlay(level);
    }
}

// ---- GENEROV√ÅN√ç OVOCE ----
function spawnSquare() {
    if (!gameRunning) return;

    const square = document.createElement("div");
    square.className = "square";

    square.style.width  = squareSize + "px";
    square.style.height = squareSize + "px";
    square.style.fontSize = (squareSize * 0.6) + "px";
    square.textContent = randomFruit();

    const areaW = gameArea.clientWidth  - squareSize;
    const areaH = gameArea.clientHeight - squareSize;

    square.style.left = Math.random() * areaW + "px";
    square.style.top  = Math.random() * areaH + "px";

    total++;
    totalEl.textContent = total;

    let hitRegistered = false;

    function onHit() {
        if (hitRegistered) return;
        hitRegistered = true;

        hit++;
        hitEl.textContent = hit;
        playSound(hitSound);
        square.remove();
        checkLevelUp();
    }

    // Desktop: p≈ôejet√≠ my≈°√≠ (pointerenter),
    // Mobil: ≈•uknut√≠ (pointerdown). Oba pou≈æ√≠vaj√≠ stejn√Ω handler.
    square.addEventListener("pointerenter", onHit);
    square.addEventListener("pointerdown", onHit);

    gameArea.appendChild(square);

    // Zmiz√≠ po ƒçase 'lifetime'
    setTimeout(() => {
        if (square.parentElement) {
            square.remove();
            playSound(missSound);
        }
    }, lifetime);
}

function startSpawning() {
    if (spawnInterval) return;
    spawnInterval = setInterval(spawnSquare, spawnDelay);
}

function stopSpawning() {
    clearInterval(spawnInterval);
    spawnInterval = null;
}

// ---- OVL√ÅD√ÅN√ç KL√ÅVESAMI ----
document.addEventListener("keydown", e => {
    // P = pauza
    if (e.key.toLowerCase() === "p") {
        if (gameRunning) {
            gameRunning = false;
            stopTimer();
            stopSpawning();
        } else {
            gameRunning = true;
            startTimer();
            startSpawning();
        }
    }
});

// ---- Klik/tap do hern√≠ plochy = start z pauzy ----
gameArea.addEventListener("pointerdown", () => {
    if (!gameRunning && !levelOverlay.classList.contains("visible")) {
        gameRunning = true;
        startTimer();
        startSpawning();
    }
});

// ---- START: level 1, overlay na zaƒç√°tku ----
applyDifficultyForLevel();
levelEl.textContent = level;
showLevelOverlay(level);
</script>

</body>
</html>
