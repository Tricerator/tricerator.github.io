<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Jednoduch√° hra ‚Äì Ovoce</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: #f0f0f0;
    }

    #hud {
        padding: 10px;
        background: #333;
        color: white;
        font-size: 18px;
        line-height: 1.4;
    }

    #gameArea {
        position: relative;
        width: 100vw;
        height: calc(100vh - 70px);
        background: #eee;
        overflow: hidden;
        cursor: crosshair;
    }

    .square {
        position: absolute;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 0, 0, 0.05); /* jemn√Ω hitbox */
        user-select: none;
    }

    /* LEVEL / GAME OVER OVERLAY */
    #levelOverlay {
        position: fixed;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.85);
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 48px;
        font-weight: bold;
        z-index: 9999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s linear;
    }

    #levelOverlay.visible {
        opacity: 1;
        pointer-events: auto;
    }

    #levelText {
        text-align: center;
        padding: 20px;
        animation: none;
    }

    /* Animace textu v overlayi */
    #levelOverlay.visible #levelText {
        animation: popIn 1.0s ease-out;
    }

    @keyframes popIn {
        0%   { transform: scale(0.5); opacity: 0; }
        50%  { transform: scale(1.2); opacity: 1; }
        100% { transform: scale(1.0); opacity: 1; }
    }

    /* Trochu men≈°√≠ text HUD na √∫zk√Ωch displej√≠ch */
    @media (max-width: 768px) {
        #hud {
            font-size: 14px;
        }
    }
</style>
</head>
<body>

<div id="hud">
    ‚è± ƒåas: <span id="time">0.0</span> s  
    | üéØ Z√°sahy: <span id="hit">0</span>/<span id="total">0</span>
    | üî• √örove≈à: <span id="level">1</span> (ka≈æd√Ωch 10 z√°sah≈Ø)
    | üíó ≈Ωivoty: <span id="lives">10</span>
    <br>
    ‚≠ê Sk√≥re: <span id="score">0</span>
    | ‚ö° Combo: <span id="combo">0</span> (max: <span id="bestCombo">0</span>)
    <br>
    P = pauza (PC), dvoj≈•uk/dvouprst√Ω tap = pauza (mobil)
</div>

<div id="gameArea"></div>

<div id="levelOverlay">
    <div id="levelText"></div>
</div>

<!-- Zvuky (voliteln√© ‚Äì m≈Ø≈æe≈° nahradit nebo smazat) -->
<audio id="hitSound" src="hit.wav" preload="auto"></audio>
<audio id="missSound" src="miss.wav" preload="auto"></audio>

<script>
let gameRunning           = false;
let waitingForLevelStart  = false;
let gameOver              = false;

let time   = 0;
let hit    = 0;
let total  = 0;
let level  = 1;

// NOV√â: sk√≥re a ≈æivoty
let score      = 0;
let combo      = 0;
let bestCombo  = 0;
const maxLives = 10;
let lives      = maxLives;

let timerInterval = null;
let spawnInterval = null;

// po kolika z√°saz√≠ch se zvedne level
const HITS_PER_LEVEL = 10;

// z√°kladn√≠ parametry obt√≠≈ænosti ‚Äì POMALEJ≈†√ç START
let baseSpawnDelay = 1200;   // ms (d≈ô√≠ve 800)
let baseLifetime   = 3000;   // ms (d≈ô√≠ve 2000)
let baseSquareSize = 80;     // px

const minSpawnDelay = 250;
const minLifetime   = 500;
const minSquareSize = 20;

// detekce "mal√© obrazovky"
const isSmallScreen = window.innerWidth < 768;

// pro mal√© displeje to trochu zlehƒç√≠me
if (isSmallScreen) {
    baseSquareSize = 100;
    baseLifetime   = 3200;
}

let spawnDelay = baseSpawnDelay;
let lifetime   = baseLifetime;
let squareSize = baseSquareSize;

// bezpeƒçn√° z√≥na dole na mobilu (aby ovoce nebylo u syst√©mov√Ωch tlaƒç√≠tek)
const bottomSafeZone = isSmallScreen ? 80 : 0;
const topSafeZone    = isSmallScreen ? 30 : 0;

const timeEl      = document.getElementById("time");
const hitEl       = document.getElementById("hit");
const totalEl     = document.getElementById("total");
const levelEl     = document.getElementById("level");
const livesEl     = document.getElementById("lives");
const scoreEl     = document.getElementById("score");
const comboEl     = document.getElementById("combo");
const bestComboEl = document.getElementById("bestCombo");
const gameArea    = document.getElementById("gameArea");

const levelOverlay = document.getElementById("levelOverlay");
const levelText    = document.getElementById("levelText");

const hitSound  = document.getElementById("hitSound");
const missSound = document.getElementById("missSound");

// Ovoce pro levely ‚Äì po≈ôad√≠: 1 = T≈òE≈†E≈á
const levelFruitEmojis = ["üçí","üçé","üçá","üçì","üçå","üçç","üçâ","ü•ù"];
const levelFruitNames  = ["T≈ôe≈°e≈à","Jablko","Hrozny","Jahoda","Ban√°n","Ananas","Meloun","Kiwi"];

function getFruitEmojiForLevel(l) {
    const idx = (l - 1) % levelFruitEmojis.length;
    return levelFruitEmojis[idx];
}

function getFruitNameForLevel(l) {
    const idx = (l - 1) % levelFruitNames.length;
    return levelFruitNames[idx];
}

// ---- ƒåASOM√çRA ----
function startTimer() {
    if (timerInterval) return;
    timerInterval = setInterval(() => {
        time += 0.1;
        timeEl.textContent = time.toFixed(1);
    }, 100);
}

function stopTimer() {
    clearInterval(timerInterval);
    timerInterval = null;
}

// ---- ZVUKY ----
function playSound(sound) {
    if (!sound) return;
    try {
        sound.currentTime = 0;
        sound.play();
    } catch (e) {
        // autoplay blok ‚Äì ignorujeme
    }
}

// ---- OBT√ç≈ΩNOST PODLE LEVELU ----
function applyDifficult
